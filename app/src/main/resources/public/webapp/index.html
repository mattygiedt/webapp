<!DOCTYPE HTML>
<!--
 .----------------.  .----------------.  .----------------.  .----------------.  .----------------.  .----------------.  .----------------.
| .--------------. || .--------------. || .--------------. || .--------------. || .--------------. || .--------------. || .--------------. |
| |  ____  ____  | || |      __      | || |     ______   | || |  ___  ____   | || |  _________   | || |  _______     | || |    _______   | |
| | |_   ||   _| | || |     /  \     | || |   .' ___  |  | || | |_  ||_  _|  | || | |_   ___  |  | || | |_   __ \    | || |   /  ___  |  | |
| |   | |__| |   | || |    / /\ \    | || |  / .'   \_|  | || |   | |_/ /    | || |   | |_  \_|  | || |   | |__) |   | || |  |  (__ \_|  | |
| |   |  __  |   | || |   / ____ \   | || |  | |         | || |   |  __'.    | || |   |  _|  _   | || |   |  __ /    | || |   '.___`-.   | |
| |  _| |  | |_  | || | _/ /    \ \_ | || |  \ `.___.'\  | || |  _| |  \ \_  | || |  _| |___/ |  | || |  _| |  \ \_  | || |  |`\____) |  | |
| | |____||____| | || ||____|  |____|| || |   `._____.'  | || | |____||____| | || | |_________|  | || | |____| |___| | || |  |_______.'  | |
| |              | || |              | || |              | || |              | || |              | || |              | || |              | |
| '--------------' || '--------------' || '--------------' || '--------------' || '--------------' || '--------------' || '--------------' |
 '----------------'  '----------------'  '----------------'  '----------------'  '----------------'  '----------------'  '----------------'
 .----------------.  .----------------.  .----------------.  .----------------.
| .--------------. || .--------------. || .--------------. || .--------------. |
| |  _______     | || |  _________   | || |      __      | || |  ________    | |
| | |_   __ \    | || | |_   ___  |  | || |     /  \     | || | |_   ___ `.  | |
| |   | |__) |   | || |   | |_  \_|  | || |    / /\ \    | || |   | |   `. \ | |
| |   |  __ /    | || |   |  _|  _   | || |   / ____ \   | || |   | |    | | | |
| |  _| |  \ \_  | || |  _| |___/ |  | || | _/ /    \ \_ | || |  _| |___.' / | |
| | |____| |___| | || | |_________|  | || ||____|  |____|| || | |________.'  | |
| |              | || |              | || |              | || |              | |
| '--------------' || '--------------' || '--------------' || '--------------' |
 '----------------'  '----------------'  '----------------'  '----------------'
 .----------------.  .----------------.  .----------------.
| .--------------. || .--------------. || .--------------. |
| |  _________   | || |  ____  ____  | || |  _________   | |
| | |  _   _  |  | || | |_   ||   _| | || | |_   ___  |  | |
| | |_/ | | \_|  | || |   | |__| |   | || |   | |_  \_|  | |
| |     | |      | || |   |  __  |   | || |   |  _|  _   | |
| |    _| |_     | || |  _| |  | |_  | || |  _| |___/ |  | |
| |   |_____|    | || | |____||____| | || | |_________|  | |
| |              | || |              | || |              | |
| '--------------' || '--------------' || '--------------' |
 '----------------'  '----------------'  '----------------'
 .----------------.  .----------------.  .----------------.  .----------------.  .----------------.  .----------------.
| .--------------. || .--------------. || .--------------. || .--------------. || .--------------. || .--------------. |
| |    _______   | || |     ____     | || | _____  _____ | || |  _______     | || |     ______   | || |  _________   | |
| |   /  ___  |  | || |   .'    `.   | || ||_   _||_   _|| || | |_   __ \    | || |   .' ___  |  | || | |_   ___  |  | |
| |  |  (__ \_|  | || |  /  .--.  \  | || |  | |    | |  | || |   | |__) |   | || |  / .'   \_|  | || |   | |_  \_|  | |
| |   '.___`-.   | || |  | |    | |  | || |  | '    ' |  | || |   |  __ /    | || |  | |         | || |   |  _|  _   | |
| |  |`\____) |  | || |  \  `--'  /  | || |   \ `--' /   | || |  _| |  \ \_  | || |  \ `.___.'\  | || |  _| |___/ |  | |
| |  |_______.'  | || |   `.____.'   | || |    `.__.'    | || | |____| |___| | || |   `._____.'  | || | |_________|  | |
| |              | || |              | || |              | || |              | || |              | || |              | |
| '--------------' || '--------------' || '--------------' || '--------------' || '--------------' || '--------------' |
 '----------------'  '----------------'  '----------------'  '----------------'  '----------------'  '----------------'
-->

<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css"
        integrity="sha512-P5MgMn1jBN01asBgU0z60Qk4QxiXo86+wlFahKrsQf37c9cro517WzVSPPV1tDKzhku2iJ2FVgL67wG03SGnNA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.18.3/bootstrap-table.min.css"
        integrity="sha512-5RNDl2gYvm6wpoVAU4J2+cMGZQeE2o4/AksK/bi355p/C31aRibC93EYxXczXq3ja2PJj60uifzcocu2Ca2FBg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.18.3/extensions/filter-control/bootstrap-table-filter-control.min.css"
        integrity="sha512-IK+plgQ3Qomdj9Mzq2WbM5LF8JY0PPXHGGfiBqBkwhXUi1tVAIvIaLbt330r3t0Y4EUxqG0YGfEhRrQS0gKeYQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <title>Example Bootstrap Single-Page Webapp</title>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark" style="background-color: #6f42c1;">
        <a class="navbar-brand" href="">Internal Crossing Tool</a>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" id='strategy-page-nav' href="#"
                        onclick="showPage( 'strategy-page' );">Strategy</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id='sweeper-page-nav' href="#" onclick="showPage( 'sweeper-page' );">Sweeper</a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="container-fluid" style="padding-left: 15px;">
        <div class="row" id="strategy-page" style="display: none;">
            <div class="col-12">
                <hr />
                <div class="card">
                    <div class="card-header card-title">
                        <h4>Crossing Trade</h4>
                    </div>
                    <div class="card-body">
                        <form id="cross-form">

                            <div class="form-group row">
                                <label for="cross-form-alpha-strategy" class="col-sm-2 col-form-label">
                                    <p class="font-weight-bold">Driving Strategy</p>
                                </label>
                                <div class="col-sm-4">
                                    <select class="form-control form-control-lg" id="cross-form-driving-strategy-select"
                                        onchange="fireStrategyPositions(this)">
                                        <option value="" selected disabled hidden>Select Strategy...</option>
                                    </select>
                                </div>
                                <div class="col-sm-4">
                                    <select class="form-control form-control-lg"
                                        id="cross-form-alpha-strategy-side-code"
                                        onchange="fireStrategySideCodeSelect(this)">
                                        <option value="" selected disabled hidden>Side Code...</option>
                                        <option value="Buy">BUY</option>
                                        <option value="Sell">SELL</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group row">
                                <label for="cross-form-target-strategy" class="col-sm-2 col-form-label">
                                    <p class="font-weight-bold">Target Strategy</p>
                                </label>
                                <div class="col-sm-4">
                                    <select class="form-control form-control-lg" id="cross-form-target-strategy-select">
                                        <option value="" selected disabled hidden>Select Strategy...</option>
                                    </select>
                                </div>
                                <div class="col-sm-4">
                                    <input type="text" readonly style="padding-left:20px;"
                                        class="form-control form-control-lg form-control-plaintext"
                                        id="cross-form-target-strategy-side-code" placeholder="">
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="col-sm-12" style="padding-bottom:10px">
                                    <hr />
                                </div>
                            </div>

                            <div class="form-group row">
                                <label for="cross-form-cusip" class="col-sm-2 col-form-label">
                                    <p class="font-weight-bold">Cusip</p>
                                </label>
                                <div class="col-sm-4">
                                    <input type="text" class="form-control form-control-lg" id="cusip-form-input"
                                        placeholder="cusip ...">
                                </div>
                                <div class="col-sm-4">
                                    <button id="validate-cusip-submit-button" type="submit"
                                        class="btn btn-secondary btn-lg">Validate</button>
                                </div>
                            </div>

                            <div class="form-group row">
                                <label for="cross-form-security" class="col-sm-2 col-form-label">
                                    <p class="font-weight-bold">Security Name</p>
                                </label>
                                <div class="col-sm-6">
                                    <input type="text" readonly style="padding-left:20px;"
                                        class="form-control form-control-lg form-control-plaintext"
                                        id="cross-form-security" placeholder="">
                                </div>
                            </div>

                            <div class="form-row">
                                <p>Required Fields</p>
                            </div>

                            <div class="form-row">
                                <div class="col-6">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <div class="input-group-text">Prc</div>
                                        </div>
                                        <input type="text" class="form-control" id="cross-form-price"
                                            placeholder="0.00">
                                        <div class="input-group-append">
                                            <div class="input-group-text">$</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-6">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <div class="input-group-text">Qty</div>
                                        </div>
                                        <input type="text" class="form-control" id="cross-form-quantity"
                                            placeholder="0">
                                        <div class="input-group-append">
                                            <span class="input-group-text">(,000)</span>
                                        </div>
                                        <div class="input-group-append">
                                            <button class="btn btn-secondary" type="button"
                                                onclick="fireUpdatePriceWithRE()">Calc RE</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <p>Optional Fields</p>
                            </div>

                            <div class="form-row">
                                <div class="col-4">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <div class="input-group-text">AllInTv</div>
                                        </div>
                                        <input type="text" class="form-control" id="cross-form-allintv"
                                            placeholder="0.00">
                                        <div class="input-group-append">
                                            <span class="input-group-text">bps</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-4">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <div class="input-group-text">RE</div>
                                        </div>
                                        <input type="text" class="form-control" id="cross-form-re" placeholder="0.00">
                                        <div class="input-group-append">
                                            <span class="input-group-text">$</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-4">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <div class="input-group-text">Signal</div>
                                        </div>
                                        <input type="text" class="form-control" id="cross-form-signal"
                                            placeholder="0.00">
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="col-4">
                                    <button id="cross-submit-button" type="submit" class="btn btn-primary btn-lg"
                                        disabled>Submit</button>
                                    <button id="reset-button" type="button" class="btn btn-dark btn-lg">Reset</button>
                                </div>

                            </div>

                            <input type="hidden" id="cross-form-cusip">
                            <input type="hidden" id="cross-form-figi">
                            <input type="hidden" id="cross-form-ticker">

                        </form>
                    </div>
                </div>

                <hr />
                <div class="card">
                    <div class="card-header">
                        <form class="form-inline">
                            <h4 style="padding-right:20px;"><span id="position-strategy-name"></span> Positions</h4>
                        </form>
                    </div>
                    <div class="card-body">
                        <table id="credit-alpha-positions-table" data-toggle="table" data-search="false"
                            data-search-on-enter-key="false" data-sort-name="security" data-sort-order="desc"
                            data-unique-id="cusip" data-classes="table table-sm table-bordered table-hover"
                            data-show-columns="false" data-page-size="100" data-pagination="false">
                            <thead>
                                <tr>
                                    <th data-field="security" data-sortable="true">Security</th>
                                    <th data-field="ticker" data-sortable="true">Ticker</th>
                                    <th data-field="cusip" data-sortable="true">CUSIP</th>
                                    <th data-field="net" data-formatter="quantityFormatter" data-sortable="true">Net
                                    </th>
                                    <th data-field="open" data-formatter="quantityFormatter" data-sortable="true">Open
                                    </th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
                <br /><br />
            </div> <!-- -->
        </div> <!-- -->

        <!-- -->
        <div class="row" id="sweeper-page" style="display: none;">
            <div class="col-12">
                <hr />
                <form id="sweeper-form">
                    <div class="form-row">
                        <label for="sweeper-submit-button" class="col-form-label col-form-label-lg">
                            <h4>Execute</h4>
                        </label>
                        <div class="col-2">
                            <button id="sweeper-submit-button" type="submit"
                                class="btn btn-primary btn-lg">Sweep</button>
                        </div>
                        <div class="col-6">
                            <div class="alert alert-primary" role="alert" id="sweeper-submit-wait">
                                <div class="spinner-border spinner-border-sm" role="status"></div>
                                Please wait...
                            </div>
                            <div class="alert alert-success" role="alert" id="sweeper-submit-success">
                                Sweep sucessfully completed!
                            </div>
                            <div class="alert alert-danger" role="alert" id="sweeper-submit-error">
                                Oh no! Delete the completed trades shown below!
                            </div>
                        </div>
                    </div>
                </form>
                <hr />
                <div class="card">
                    <div class="card-header">
                        <h4>Completed Trades</h4>
                    </div>
                    <div class="card-body">
                        <table id="sweeper-completed-trade-table" data-toggle="table" data-search="false"
                            data-search-on-enter-key="false" data-sort-name="strategy" data-sort-order="desc"
                            data-unique-id="cusip" data-classes="table table-sm table-bordered table-hover"
                            data-show-columns="false" data-page-size="100" data-pagination="false">
                            <thead>
                                <tr>
                                    <th data-field="strategy" data-sortable="true">Strategy</th>
                                    <th data-field="cusip" data-sortable="true">Cusip</th>
                                    <th data-field="side" data-sortable="true">Side Code</th>
                                    <th data-field="quantity" data-formatter="quantityFormatter" data-sortable="true">
                                        Quantity</th>
                                    <th data-field="price" data-formatter="priceFormatter" data-sortable="true">Price
                                    </th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
                <br /><br />
            </div> <!-- -->
        </div> <!-- -->
    </div>

    <div class="modal fade" id="invalid-submit-modal" tabindex="-1" aria-labelledby="invalid-submit-modal-label"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="invalid-submit-modal-label">Error: Invalid or Missing Data</h5>
                </div>
                <div class="modal-body">
                    <div class="card" style="width: 18rem;">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">Driving Strategy: <span class="text-right"
                                    id="invalid-submit-modal-driving-strategy"></span></li>
                            <li class="list-group-item">Target Strategy: <span class="text-right"
                                    id="invalid-submit-modal-target-strategy"></span></li>
                            <li class="list-group-item">Price: <span class="text-right"
                                    id="invalid-submit-modal-price"></span></li>
                            <li class="list-group-item">Quantity: <span class="text-right"
                                    id="invalid-submit-modal-quantity"></span></li>
                            <li class="list-group-item">Side Code: <span class="text-right"
                                    id="invalid-submit-modal-side-code"></span></li>
                        </ul>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="confirm-submit-modal" tabindex="-1" aria-labelledby="confirm-submit-modal-label"
        aria-hidden="true" data-backdrop="static">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="confirm-submit-modal-label">Confirm Order Details</h5>
                </div>
                <div class="modal-body">
                    <div class="card-deck">
                        <div class="card">
                            <div class="card-header">
                                <h5><span id="confirm-submit-modal-driving-strategy"></span> Trade</h5>
                            </div>
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item">Security: <span
                                        id="confirm-submit-modal-security-alpha"></span></li>
                                <li class="list-group-item">Side Code: <span
                                        id="confirm-submit-modal-side-code-alpha"></span></li>
                                <li class="list-group-item">Price: <span id="confirm-submit-modal-price-alpha"></span>
                                </li>
                                <li class="list-group-item">Quantity: <span
                                        id="confirm-submit-modal-quantity-alpha"></span></li>
                            </ul>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <h5><span id="confirm-submit-modal-target-strategy"></span> Trade</h5>
                            </div>
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item">Security: <span id="confirm-submit-modal-security"></span>
                                </li>
                                <li class="list-group-item">Side Code: <span id="confirm-submit-modal-side-code"></span>
                                </li>
                                <li class="list-group-item">Price: <span id="confirm-submit-modal-price"></span></li>
                                <li class="list-group-item">Quantity: <span id="confirm-submit-modal-quantity"></span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <br />
                    <div class="alert alert-primary" role="alert" id="confirm-submit-modal-wait">
                        <div class="spinner-border spinner-border-sm" role="status"></div>
                        Please wait...
                    </div>
                    <div class="alert alert-success" role="alert" id="confirm-submit-modal-success">Success!</div>
                    <div class="alert alert-danger" role="alert" id="confirm-submit-modal-failure">Oh No! There was an
                        error!</div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="confirm-submit-modal-button">Submit</button>
                    <button type="button" class="btn btn-secondary" id="close-submit-modal-button"
                        data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"
        integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA=="
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.bundle.min.js"
        integrity="sha512-wV7Yj1alIZDqZFCUQJy85VN+qvEIly93fIQAN7iqDFCPEucLCeNFz4r35FCo9s6WrpdDQPi80xbljXB8Bjtvcg=="
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.18.3/bootstrap-table.min.js"
        integrity="sha512-Wm00XTqNHcGqQgiDlZVpK4QIhO2MmMJfzNJfh8wwbBC9BR0FtdJwPqDhEYy8jCfKEhWWZe/LDB6FwY7YE9QhMg=="
        crossorigin="anonymous"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.18.3/extensions/filter-control/bootstrap-table-filter-control.min.js"
        integrity="sha512-nrE3yoRxAz6j1ZhkE59hXcSKV0cewPN+8ZEXJZnsz2qofCEOwmctecuKrBnWQUj7UA5dOnI+Cam52/AdvB6HKQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"
        integrity="sha512-T/tUfKSV1bihCnd+MxKD0Hm1uBBroVYBOYSk1knyvQ9VyZJpc/ALb4P0r6ubwVPSGB2GvjeoMAJJImBG12TiaQ=="
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/numeral.js/2.0.6/numeral.min.js"
        integrity="sha512-USPCA7jmJHlCNRSFwUFq3lAm9SaOjwG8TaB8riqx3i/dAJqhaYilVnaf2eVUH5zjq89BU6YguUuAno+jpRvUqA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script type="text/javascript" charset="utf-8">
        var visiblePage = null;

        function showPage(page) {
            if (visiblePage) {
                $('#' + visiblePage).hide();
            }

            visiblePage = page;
            $('#' + visiblePage).show();
        }

        function quantityFormatter(value) {
            return numeral(value).format('0,0');
        }

        function priceFormatter(value) {
            return numeral(value).format('$0,0.00');
        }

        function loadPositions(positions) {
            $('#credit-alpha-positions-table').bootstrapTable('removeAll');

            rows = []
            for (key in positions) {
                rows.push({
                    security: positions[key].security,
                    ticker: positions[key].ticker,
                    cusip: positions[key].cusip,
                    net: positions[key].net,
                    open: positions[key].open
                });
            }

            $('#credit-alpha-positions-table').bootstrapTable('load', rows);
        }

        function fireUpdatePriceWithRE() {
            var side_code = $('#cross-form-alpha-strategy-side-code').val();
            var price = $('#cross-form-price').val();
            var quantity = $('#cross-form-quantity').val();
            var re = $('#cross-form-re').val();

            if (!price || !side_code || !quantity || !re) {
                return;
            }

            if (side_code == 'Sell') {
                re *= -1;
            }

            offset = ((quantity * re) / 500);
            price = +price + offset;

            $('#cross-form-price').val(numeral(price).format('0.000'));
        }

        function fireStrategyPositions(select_obj) {
            var strategy = select_obj.value;
            var strategyName = select_obj.options[select_obj.selectedIndex].text

            console.log('fireStrategyPositions', strategyName);

            $('#position-strategy-name').text(strategyName)

            $.get("/positions/" + strategy, function (response) {
                console.log('positions', response);
                positions = JSON.parse(response);
                loadPositions(positions);
            });
        }

        function fireStrategySideCodeSelect(select_obj) {
            var side_code = select_obj.value;
            console.log(side_code)

            if (side_code == "Buy") {
                $('#cross-form-target-strategy-side-code').val("SELL");
            } else {
                $('#cross-form-target-strategy-side-code').val("BUY");
            }
        }

        $(document).ready(function () {

            // Set header NAV active on clicks
            $(document).on('click', '.nav-item a', function (e) {
                $(this).parent().addClass('active').siblings().removeClass('active');
            });

            // Load strategies
            $.get("/strategies", function (response) {
                strategies = JSON.parse(response);
                for (const [key, value] of Object.entries(strategies)) {
                    console.log(value, key);
                    $("#cross-form-driving-strategy-select").append(new Option(key, value));
                    $("#cross-form-target-strategy-select").append(new Option(key, value));
                }
            });

            var websocket_addr = "ws://" + location.hostname + ":" + location.port + "/websocket";
            console.log("using websocket addr: " + websocket_addr);

            var socket = new WebSocket(websocket_addr);

            socket.onopen = (event) => {
                console.log('socket.onopen', event);
            };

            socket.onmessage = (event) => {
                console.log('socket.onmessage', event);
                const msg = JSON.parse(event.data);
            };

            socket.onclose = (event) => {
                console.log('socket.onclose', event);
            };

            $('#sweeper-submit-wait').hide();
            $('#sweeper-submit-success').hide();
            $('#sweeper-submit-error').hide();

            showPage('strategy-page');
        });
    </script>
</body>

</html>
